<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=windows-1252">
	<TITLE></TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice.org 3.0  (Win32)">
	<META NAME="AUTHOR" CONTENT="Philip Nienhuis">
	<META NAME="CREATED" CONTENT="20091229;22213000">
	<META NAME="CHANGEDBY" CONTENT="Philip Nienhuis">
	<META NAME="CHANGED" CONTENT="20091230;17155100">
	<META NAME="Info 1" CONTENT="">
	<META NAME="Info 2" CONTENT="">
	<META NAME="Info 3" CONTENT="">
	<META NAME="Info 4" CONTENT="">
	<META NAME="CHANGEDBY" CONTENT="Philip Nienhuis">
	<STYLE TYPE="text/css">
	<!--
		@page { margin: 0.79in }
		P { margin-bottom: 0.08in }
		A:link { so-language: zxx }
	-->
	</STYLE>
</HEAD>
<BODY LANG="en-US" DIR="LTR">
<P ALIGN=CENTER STYLE="margin-bottom: 0in"><U><FONT FACE="Arial, sans-serif"><FONT SIZE=4 STYLE="font-size: 16pt"><B>ODS
support for Octave</B></U></FONT></FONT></P>
<P ALIGN=CENTER STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=CENTER STYLE="margin-bottom: 0in"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>Copyright
&copy; 2009 Philip Nienhuis &lt;prnienhuis at users.sf.net&gt;</FONT></FONT></P>
<P ALIGN=CENTER STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=CENTER STYLE="margin-bottom: 0in"><FONT FACE="Arial, sans-serif"><FONT SIZE=2>This
version December 29, 2009</FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in"><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt"><I>(ODS
= Open Document Format spreadsheet data format, used by e.g.,
OpenOffice.org.)</I></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in"><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt"><U><B>Files
content</B></U></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-left: 1.98in; text-indent: -1.98in; margin-bottom: 0in">
<FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt"><I><B>odsread.m</B></I></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 0.01in; margin-bottom: 0in"><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">No-hassle
read script for reading from an ODS file and parsing the numeric and
text data into separate arrays.</FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-left: 1.98in; text-indent: -1.98in; margin-bottom: 0in">
<FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt"><I><B>odsopen.m</B></I></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 1.98in; text-indent: -1.98in; margin-bottom: 0in">
<FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">Get
a file pointer to an ODS spreadsheet file.</FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 0.01in; margin-bottom: 0in"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-left: 0.01in; margin-bottom: 0in"><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt"><I><B>ods2oct.m</B></I></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 0.01in; margin-bottom: 0in"><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">Read
raw data from an ODS spreadsheet file using the file pointer handed
by odsopen.</FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 0.01in; margin-bottom: 0in"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-left: 0.01in; margin-bottom: 0in"><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt"><I><B>odsclose.m</B></I></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 0.01in; margin-bottom: 0in"><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">Close
file handle made by odsopen.</FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 0.01in; margin-bottom: 0in"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-left: 0.01in; margin-bottom: 0in"><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt"><I><B>odsfinfo.m</B></I></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 0.01in; margin-bottom: 0in"><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">Explore
sheet names and optionally estimated data size of ods files with
unknown content.</FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 0.01in; margin-bottom: 0in"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-left: 0.01in; margin-bottom: 0in"><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt"><I><B>calccelladdress.m</B></I></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 0.01in; margin-bottom: 0in"><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">Utility
function needed for jOpenDocument class.</FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 0.01in; margin-bottom: 0in"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-left: 0.01in; margin-bottom: 0in"><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt"><I><B>parsecell.m</B></I></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 0.01in; margin-bottom: 0in"><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">(contained
in Excel xlsread scripts, but works also for ods support) parse raw
data (cell array) into separate numeric array and text (cell) array.)</FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 0.01in; margin-bottom: 0in"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-left: 0.01in; margin-bottom: 0in"><BR>
</P>
<P ALIGN=CENTER STYLE="margin-left: 0.01in; margin-bottom: 0in"><FONT FACE="Arial, sans-serif"><FONT SIZE=4 STYLE="font-size: 15pt"><U><B>REQUIRED
SUPPORT SOFTWARE</B></U></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-left: 1.98in; text-indent: -1.98in; margin-bottom: 0in">
<BR>
</P>
<P ALIGN=LEFT STYLE="margin-left: 1.98in; text-indent: -1.98in; margin-bottom: 0in">
<FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">For
Windows (MingW):</FONT></FONT></P>
<UL>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0in"><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">octave
	with java package (&gt;= 1.2.6)</FONT></FONT></P>
</UL>
<P ALIGN=LEFT STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in"><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">For
Linux:</FONT></FONT></P>
<UL>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0in"><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">octave
	with java package (&gt;= 1.2.5; earlier versions not tested)</FONT></FONT></P>
</UL>
<P ALIGN=LEFT STYLE="margin-bottom: 0in"><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">For
ODS access, you'll need one of the following java class files</FONT></FONT></P>
<UL>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0in"><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">(currently
	the preferred option) <B>odfdom.jar</B> &amp; <B>xercesImpl.jar</B>.
	Get them here:</FONT></FONT></P>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0in"><A HREF="http://odftoolkit.org/projects/odfdom/downloads/directory/current-version"><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">http://odftoolkit.org/projects/odfdom/downloads/directory/current-version</FONT></FONT></A></P>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0in"><A HREF="http://xerces.apache.org/mirrors.cgi"><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">http://xerces.apache.org/mirrors.cgi</FONT></FONT></A></P>
</UL>
<P ALIGN=LEFT STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in"><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">and/or</FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in"><BR>
</P>
<UL>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0in"><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt"><B>jopendocument</B></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt"><SPAN STYLE="font-weight: normal">&lt;version&gt;</SPAN></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt"><B>.jar</B></FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">.
	Get it from <A HREF="http://www.jopendocument.org/">http://www.jopendocument.org</A></FONT></FONT></P>
</UL>
<P ALIGN=LEFT STYLE="margin-bottom: 0in"><BR>
</P>
<UL>
	<P ALIGN=LEFT STYLE="margin-bottom: 0in"><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">These,
	plus the </FONT></FONT><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt"><B>rt.jar</B></FONT></FONT>
	<FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt"><SPAN STYLE="font-weight: normal">from
	your local java installation (jre or jdk) must be referenced with
	full pathnames in your javaclasspath. Hint: add it in
	./share/octave/&lt;version&gt;/m/startup/octavercusing appropriate
	javaaddpath statements.</SPAN></FONT></FONT></P>
</UL>
<P ALIGN=LEFT STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=CENTER STYLE="margin-left: 0.01in; margin-bottom: 0in"><FONT FACE="Arial, sans-serif"><FONT SIZE=4 STYLE="font-size: 15pt"><U><B>USAGE</B></U></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in; font-weight: normal; text-decoration: none">
<FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">(see
&ldquo;help ods&lt;function_filename&gt;&rdquo; in octave terminal.)</FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in"><SPAN STYLE="text-decoration: none"><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt"><B>odsread</B></FONT></FONT></SPAN><SPAN STYLE="text-decoration: none">
</SPAN><SPAN STYLE="text-decoration: none"><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt"><SPAN STYLE="font-weight: normal">is
a sort of analog to xlsread and works more or less the same. </SPAN></FONT></FONT></SPAN><SPAN STYLE="text-decoration: none"><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt"><B>odsread
</B></FONT></FONT></SPAN><SPAN STYLE="text-decoration: none"><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt"><SPAN STYLE="font-weight: normal">is
a mere wrapper for the functions </SPAN></FONT></FONT></SPAN><SPAN STYLE="text-decoration: none"><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt"><B>odsopen</B></FONT></FONT></SPAN><SPAN STYLE="text-decoration: none"><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt"><SPAN STYLE="font-weight: normal">,</SPAN></FONT></FONT></SPAN><SPAN STYLE="text-decoration: none"><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt"><B>ods2oct,</B></FONT></FONT></SPAN><SPAN STYLE="text-decoration: none">
</SPAN><SPAN STYLE="text-decoration: none"><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt"><SPAN STYLE="font-weight: normal">and
</SPAN></FONT></FONT></SPAN><SPAN STYLE="text-decoration: none"><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt"><B>odsclos</B></FONT></FONT></SPAN><SPAN STYLE="text-decoration: none"><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt"><SPAN STYLE="font-weight: normal">e
that do file access and the actual reading, plus </SPAN></FONT></FONT></SPAN><SPAN STYLE="text-decoration: none"><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt"><B>parsecell</B></FONT></FONT></SPAN><SPAN STYLE="text-decoration: none">
</SPAN><SPAN STYLE="text-decoration: none"><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt"><SPAN STYLE="font-weight: normal">for
post-processing.</SPAN></FONT></FONT></SPAN></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in"><SPAN STYLE="text-decoration: none"><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt"><B>odsfinfo</B></FONT></FONT></SPAN><SPAN STYLE="text-decoration: none">
</SPAN><SPAN STYLE="text-decoration: none"><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt"><SPAN STYLE="font-weight: normal">can
be used to explore odsfiles with unknown content for sheet names and
to get an impression of the data content sizes.</SPAN></FONT></FONT></SPAN></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in; font-weight: normal; text-decoration: none">
<FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">When
you need data from just one sheet, odsread is for you. </FONT></FONT>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in; font-weight: normal; text-decoration: none">
<FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">But
when you need data from multiple sheets in the same spreadsheet file,
or if you want to process spreadsheet data by limited-size chunks at
a time, odsopen / ods2oct [/parsecell] / &hellip; / odsclose
sequences provides for much more speed and flexibility as the
spreadsheet needs to be read just once rather than repeatedly for
each call to odsread.</FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in; font-weight: normal; text-decoration: none">
<FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">Also,
if you use odsopen / &hellip;../, you can process multiple
spreadsheets simultaneously &ndash; just use odsopen repeatedly to
get multiple spreadsheet file pointers.</FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in; font-weight: normal; text-decoration: none">
<FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">If
you use odsopen / ods2oct / &hellip; / odsclose, DO NOT FORGET to
invoke odsclose in the end. The file pointers can contain an enormous
amount of data and may unneededly keep precious memory allocated.</FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=CENTER STYLE="margin-left: 0.01in; margin-bottom: 0in"><FONT FACE="Arial, sans-serif"><FONT SIZE=4 STYLE="font-size: 15pt"><U><B>GOTCHAS</B></U></FONT></FONT></P>
<P ALIGN=CENTER STYLE="margin-left: 0.01in; margin-bottom: 0in"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in; font-weight: normal; text-decoration: none">
<FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">I
know of one big gotcha: reading dates (&amp; time).</FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in; font-weight: normal; text-decoration: none">
<FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">Octave
(as does Matlab) stores dates as a number representing the number of
days since January 1, 0 (and as an aside ignores a.o. pope Gregorius'
intervention in 1582 when 10 days were simply skipped).</FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in; font-weight: normal; text-decoration: none">
<FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">OpenOffice.org
stores dates as text strings like &ldquo;yyyy-mm-dd&rdquo;.</FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in; font-weight: normal; text-decoration: none">
<FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">MS-Excel
stores dates as a number representing the number of days since
January 1, 1900 (and as an aside, erroneously assumes 1900 to be a
leap year).</FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in; font-weight: normal; text-decoration: none">
<FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">Now,
converting OpenOffice.org date cell values into Octave looks pretty
straightforward. But when the ODS spreadsheet was originally an Excel
spreadsheet converted by OpenOffice.org, the date cells can either be
OOo date values (i.e.,strings) OR old numerical values from the Excel
spreadsheet. </FONT></FONT>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in; font-weight: normal; text-decoration: none">
<FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">So:
you should carefully check what happens to date cells.</FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in; font-weight: normal; text-decoration: none">
<BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in; font-weight: normal; text-decoration: none">
<FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">Smaller
gotcha's (only with jOpenDocument):</FONT></FONT></P>
<UL>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0in"><SPAN STYLE="text-decoration: none"><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt"><SPAN STYLE="font-weight: normal">Sometimes
	empty cells are not skipped but interpreted with numerical value 0
	(zero).</SPAN></FONT></FONT></SPAN></P>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0in"><SPAN STYLE="text-decoration: none"><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt"><SPAN STYLE="font-weight: normal">A
	valid range MUST be specified, I haven't found a way to discover the
	actual occupied rows and columns (jOpenDocument can give the
	physical (= capacity) but that doesn't help).</SPAN></FONT></FONT></SPAN></P>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0in"><SPAN STYLE="text-decoration: none"><FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt"><SPAN STYLE="font-weight: normal">Sheet
	names cannot be extracted yet, so odsfinfo won't work with
	jOpenDocument.</SPAN></FONT></FONT></SPAN></P>
</UL>
<P ALIGN=LEFT STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=CENTER STYLE="margin-left: 0.01in; margin-bottom: 0in"><FONT FACE="Arial, sans-serif"><FONT SIZE=4 STYLE="font-size: 15pt"><U><B>MATLAB
COMPATIBILITY</B></U></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in; font-weight: normal; text-decoration: none">
<FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">AFAIK
there's no similar functionality in Matlab (yet?).</FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in; font-weight: normal; text-decoration: none">
<FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">odsread
is fairly function-compatible to xlsread, however. </FONT></FONT>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in; font-weight: normal; text-decoration: none">
<FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">Same
goes for odsfinfo and xlsfinfo &ndash; however odsinfo has better
functionality IMO.</FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=CENTER STYLE="margin-left: 0.01in; margin-bottom: 0in"><FONT FACE="Arial, sans-serif"><FONT SIZE=4 STYLE="font-size: 15pt"><U><B>COMPARISON
OF INTERFACES</B></U></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in; font-weight: normal; text-decoration: none">
<FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">The
ODFtoolkit (&amp; associated xerces) interface is the one that gives
the best results at present. However, parsing xml trees into
rectangular arrays can be a nightmare and odftoolkit does little to
hide the gory details for the developers. </FONT></FONT>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in; font-weight: normal; text-decoration: none">
<FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">Reading
is still OK, but writing implies checking whether cells already exist
explicitly (in table:table-cells) or implicitly (in
number-columns-repeated or number-rows-repeated nodes) or not at all
yet in which case you'll need to add various types of parent nodes.
Inserting new cells (&ldquo;nodes&rdquo;) or deleting nodes implies
rebuilding possibly large parts of the tree in memory - nothing for
the faint-of-heart. And odftoolkit lets you sort out most of this all
by yourself.</FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in; font-weight: normal; text-decoration: none">
<FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">The
jOpenDocument interface is the most promising, as it does shield the
xml tree details and presents developers something which looks like a
spreadsheet model.</FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in; font-weight: normal; text-decoration: none">
<FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">However,
unfortunately the developers decided to shield essential methods by
making them 'protected' (e.g. the vital getCellType). Extracting
sheet names is not implemented (yet).</FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in; font-weight: normal; text-decoration: none">
<FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">JopenDocument
does support writing, however I couldn't reliably create new
MutableCells beyond column 1 no matter how hard I tried. So there's
still bugs.</FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in; font-weight: normal; text-decoration: none">
<FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">And
last (but not least) the jOpenDocument developers state that their
development is primarily driven by requests from customers who pay
for support. I do sympathize with this business model but for octave
needs this shuts the door for some time to come.</FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=CENTER STYLE="margin-left: 0.01in; margin-bottom: 0in"><FONT FACE="Arial, sans-serif"><FONT SIZE=4 STYLE="font-size: 15pt"><U><B>DEVELOPMENT</B></U></FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in; font-weight: normal; text-decoration: none">
<FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">As
with the Excel r/w stuff, adding new interfaces should be easy and
straightforward.</FONT></FONT></P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-bottom: 0in; font-weight: normal; text-decoration: none">
<FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">Suggestions
for future development:</FONT></FONT></P>
<UL>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0in; font-weight: normal; text-decoration: none">
	<FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">ODS
	write support (maybe when jOpenDocument is more mature)</FONT></FONT></P>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0in; font-weight: normal; text-decoration: none">
	<FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">Speeding
	up</FONT></FONT></P>
	<LI><P ALIGN=LEFT STYLE="margin-bottom: 0in; text-decoration: none">&ldquo;<FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt"><SPAN STYLE="font-weight: normal">Passing
	function handle&rdquo; a la Matlab's xlsread.</SPAN></FONT></FONT></P>
</UL>
<P ALIGN=LEFT STYLE="margin-left: 0.01in; margin-bottom: 0in"><BR>
</P>
<P ALIGN=LEFT STYLE="margin-left: 0.01in; margin-bottom: 0in; font-weight: normal; text-decoration: none">
<FONT FACE="Arial, sans-serif"><FONT SIZE=2 STYLE="font-size: 11pt">Enjoy!</FONT></FONT></P>
</BODY>
</HTML>