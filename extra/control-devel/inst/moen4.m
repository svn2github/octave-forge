## Copyright (C) 2012   Lukas F. Reichlin
##
## This file is part of LTI Syncope.
##
## LTI Syncope is free software: you can redistribute it and/or modify
## it under the terms of the GNU General Public License as published by
## the Free Software Foundation, either version 3 of the License, or
## (at your option) any later version.
##
## LTI Syncope is distributed in the hope that it will be useful,
## but WITHOUT ANY WARRANTY; without even the implied warranty of
## MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
## GNU General Public License for more details.
##
## You should have received a copy of the GNU General Public License
## along with LTI Syncope.  If not, see <http://www.gnu.org/licenses/>.

## -*- texinfo -*-
## @deftypefn {Function File} {[@var{sys}, @var{x0}, @var{info}] =} moen4 (@var{dat}, @dots{})
## @deftypefnx {Function File} {[@var{sys}, @var{x0}, @var{info}] =} moen4 (@var{dat}, @var{n}, @dots{})
## @deftypefnx {Function File} {[@var{sys}, @var{x0}, @var{info}] =} moen4 (@var{dat}, @var{opt}, @dots{})
## @deftypefnx {Function File} {[@var{sys}, @var{x0}, @var{info}] =} moen4 (@var{dat}, @var{n}, @var{opt}, @dots{})
## Combined method:  MOESP  algorithm for finding the
## matrices A and C, and  N4SID  algorithm for
## finding the matrices B and D.
## @end deftypefn

## Author: Lukas Reichlin <lukas.reichlin@gmail.com>
## Created: May 2012
## Version: 0.1

function [sys, x0, info] = moen4 (varargin)

  if (nargin == 0)
    print_usage ();
  endif

  [sys, x0, info] = __slicot_identification__ ("moen4", varargin{:});

endfunction


%!shared SYS, X0, INFO, Ae, Be, Ce, De, Ke, Qe, Rye, Se, X0e
%!
%! Y = [ 4.7661   5.5451   5.8503   5.3766   4.8833   5.4865   3.5378   5.3155   6.0530   4.3729
%!       4.7637   5.1886   5.9236   5.6818   4.8858   5.1495   3.5549   5.5329   6.0799   4.7417
%!       4.8394   4.8833   5.9212   5.8235   4.8931   4.8442   3.4938   5.4450   6.1287   5.0884
%!       5.0030   4.6000   5.9773   5.9529   4.7148   4.5414   3.4474   5.3961   6.0799   5.1861
%!       5.0176   4.2704   5.7405   6.0628   4.4511   4.2679   3.4401   5.2740   6.1678   5.0372
%!       5.0567   4.0384   5.3888   6.0897   4.2337   4.0604   3.4083   5.0274   6.1947   4.7856
%!       5.1544   3.8381   5.0005   6.0750   4.0433   3.9602   3.4108   4.7441   6.2362   4.5634
%!       5.3619   3.7112   4.8491   6.0262   3.8650   3.7893   3.4523   4.6684   6.0530   4.5341
%!       5.4254   3.5915   4.9444   5.9944   3.7576   3.6428   3.6818   4.6513   5.6525   4.7050
%!       5.5695   3.5353   5.1739   6.0775   3.6696   3.5256   4.0604   4.5146   5.2740   4.7417
%!       5.6818   3.4865   5.3693   5.8577   3.5939   3.4987   4.4413   4.2679   4.8589   4.6489
%!       5.7429   3.4767   5.4474   5.7014   3.5475   3.4547   4.8540   4.2606   4.5341   4.4315
%!       5.8039   3.4254   5.6037   5.7307   3.5060   3.4083   5.1544   4.2630   4.4560   4.2386
%!       5.9187   3.3815   5.7307   5.7844   3.4547   3.3790   5.4254   4.1898   4.6196   4.0652
%!       5.8210   3.3693   5.8503   5.8235   3.3986   3.3766   5.5964   4.2777   4.8662   3.9431
%!       5.4474   3.3644   5.9798   5.8943   3.3619   3.3619   5.5866   4.6000   5.1177   3.8113
%!       5.0616   3.3473   5.9920   5.7624   3.3400   3.3595   5.3546   4.9322   5.1666   3.6916
%!       4.6293   3.3815   6.0848   5.4157   3.3742   3.3693   5.0274   5.2838   5.0567   3.6525
%!       4.2679   3.4206   5.9407   4.9615   3.5207   3.3986   4.8638   5.5280   5.0030   3.8259
%!       4.0115   3.4132   5.8039   4.5952   3.7136   3.5793   4.7612   5.7405   5.0982   4.2240
%!       3.8503   3.4523   5.7917   4.3314   3.7576   3.9480   4.5707   5.8748   5.3253   4.4242
%!       3.7112   3.6355   5.6037   4.2972   3.7795   4.4120   4.3681   5.9554   5.5671   4.4291
%!       3.5695   4.0384   5.2643   4.5829   3.6965   4.5854   4.3974   5.9920   5.4670   4.3192
%!       3.5182   4.3754   4.9468   4.8613   3.7771   4.5146   4.5732   5.8455   5.2521   4.1385
%!       3.6525   4.7270   4.6196   5.1739   3.8870   4.3436   4.8418   5.5280   4.9468   3.9651
%!       3.8186   5.0567   4.5146   5.1666   3.9041   4.1556   5.2032   5.0616   4.8809   3.8870
%!       3.8626   5.2985   4.4340   4.9199   3.8503   3.9847   5.4523   4.7344   4.9810   3.8015
%!       4.0115   5.5329   4.2850   4.6074   3.9651   4.0433   5.6525   4.5341   5.2252   3.7014
%!       4.3534   5.4670   4.1214   4.3705   4.2826   4.3070   5.8552   4.5341   5.4596   3.6403
%!       4.7050   5.1959   3.9456   4.1825   4.5219   4.4218   5.9065   4.6977   5.7234   3.7673
%!       5.0836   4.8858   3.9847   4.0384   4.7148   4.3534   5.9529   4.7441   5.7917   4.1507
%!       5.3449   4.7637   4.2191   4.1458   4.9712   4.2240   5.8284   4.6196   5.9065   4.6489
%!       5.2740   4.8760   4.5463   4.4315   5.2203   4.0530   5.7917   4.6440   5.9920   4.9908
%!       5.1275   5.0420   4.8735   4.5561   5.5329   3.9407   5.7991   4.8320   5.8357   5.0884
%!       4.7612   5.2838   5.1544   4.4804   5.6525   3.8381   5.8137   5.1324   5.5280   5.0225
%!       4.4511   5.4914   5.3888   4.3754   5.7820   3.7307   5.8772   5.4108   5.1422   4.7832
%!       4.2215   5.5964   5.6135   4.3705   5.9554   3.6525   5.9554   5.6257   4.7759   4.6855
%!       4.0457   5.6721   5.8357   4.5585   6.0359   3.6110   5.7820   5.6037   4.4902   4.6660
%!       3.8748   5.7722   5.8845   4.8589   6.1190   3.5646   5.5182   5.3155   4.2362   4.7075
%!       3.7307   5.8308   5.9554   4.8955   6.1336   3.4963   5.1275   4.9615   4.0237   4.9126
%!       3.6623   5.9334   5.7624   4.7417   6.1532   3.4621   4.7637   4.6196   3.8870   5.1959
%!       3.5768   5.8992   5.4596   4.7441   6.1922   3.4547   4.4926   4.3583   3.7527   5.4157
%!       3.5427   5.9358   5.0616   4.8760   6.1434   3.4254   4.2337   4.1556   3.6818   5.6232
%!       3.4792   5.8943   4.7075   5.1055   6.1678   3.3790   4.0115   4.0335   3.8064   5.7405
%!       3.4547   5.9187   4.4584   5.2398   5.9920   3.4328   3.8552   3.8870   4.1458   5.8992
%!       3.3595   5.9944   4.2679   5.5182   5.6525   3.6232   3.6916   3.7722   4.6000   5.9285
%!       3.2985   5.9578   4.0530   5.6525   5.4596   3.9749   3.6355   3.6403   5.0030   6.0506
%!       3.2252   6.0311   3.9431   5.7234   5.4376   4.3803   3.8186   3.5329   5.3033   6.1532
%!       3.2008   6.0628   3.8259   5.8552   5.3400   4.7148   4.1556   3.4352   5.5524   5.9651
%!       3.2252   6.0408   3.9676   5.9627   5.0982   5.0738   4.5903   3.4279   5.6159   5.5866
%!       3.2276   6.0970   4.2801   5.9847   4.7856   5.3693   4.9883   3.4230   5.5231   5.3815
%!       3.2740   6.1239   4.4804   5.9847   4.4926   5.6037   5.0762   3.3986   5.6110   5.3717
%!       3.4572   6.1629   4.4926   6.0555   4.2362   5.7453   4.9077   3.6037   5.7136   5.4865
%!       3.8674   6.0408   4.3900   6.0628   4.0677   5.6525   4.6489   4.0237   5.8455   5.5671
%!       4.3217   5.8455   4.1971   6.0555   3.9334   5.4010   4.3778   4.4511   5.8992   5.8210
%!       4.4926   5.7722   4.1116   6.0701   3.8235   5.0152   4.2166   4.7930   5.9944   5.9138
%!       4.4315   5.7991   3.9822   5.7844   3.7307   4.7099   4.2875   4.9029   6.0921   5.9944
%!       4.2435   5.9236   3.8674   5.4401   3.6110   4.4169   4.5903   4.7808   6.0921   6.0115
%!       4.0506   5.9285   3.7673   5.0567   3.5646   4.2362   4.8467   4.5903   6.1434   5.9993
%!       3.8577   6.0018   3.8723   4.9419   3.5500   4.2362   5.1397   4.3363   6.1532   6.0188
%!       3.7307   6.0018   4.2362   5.0103   3.5573   4.2484   5.3888   4.1458   6.2337   5.8210
%!       3.7917   6.0604   4.6635   5.1348   3.5134   4.2215   5.6892   4.2166   6.1873   5.7282
%!       3.9212   5.8821   4.9712   5.3131   3.5158   4.2972   5.8845   4.4340   6.0140   5.7405
%!       3.9554   5.5109   5.0665   5.4792   3.6941   4.5903   6.0433   4.7148   5.8357   5.7649
%!       3.8479   5.3229   4.9029   5.6232   4.0726   4.8931   6.1703   5.0982   5.7746   5.8821
%!       3.7258   5.3717   4.6757   5.5622   4.4804   5.1348   6.2118   5.3595   5.6867   5.9260
%!       3.6110   5.4547   4.3925   5.3302   4.7050   5.4279   6.2508   5.5695   5.5378   5.7502
%!       3.7160   5.4376   4.0994   5.0103   4.6123   5.3790   6.2093   5.7722   5.3278   5.4157
%!       4.0921   5.1593   4.1141   4.6660   4.3851   5.3644   6.0140   5.9212   5.0543   4.9956
%!       4.4804   4.9029   4.3265   4.4145   4.2020   5.4523   5.7014   6.0555   4.7002   4.8613
%!       4.8149   4.5878   4.6440   4.2020   4.0262   5.5671   5.4694   5.9627   4.3949   4.9029
%!       5.0543   4.5024   4.9712   4.0482   3.9041   5.6721   5.4792   5.6428   4.1800   5.1031
%!       5.3033   4.5952   5.1593   4.0799   3.7746   5.7698   5.5573   5.4352   4.0433   5.3644
%!       5.4865   4.8247   5.3888   4.1898   3.6916   5.8308   5.7282   5.3888   3.8772   5.5964
%!       5.6721   5.0640   5.5768   4.1312   3.8455   5.9236   5.8821   5.5378   3.7527   5.7527
%!       5.7795   5.2716   5.6525   4.0042   4.2020   5.9651   5.9847   5.6818   3.7282   5.8455
%!       5.7991   5.4670   5.8039   3.9163   4.5854   6.0579   5.9016   5.7014   3.8699   5.9285
%!       5.6648   5.6159   5.9138   3.9602   4.9029   6.0506   5.5817   5.6159   4.2069   6.0066
%!       5.2911   5.5280   5.8870   4.1996   5.2569   6.0726   5.3717   5.6672   4.3558   5.8406
%!       4.8809   5.2545   5.7991   4.6245   5.5109   6.1116   5.4181   5.7405   4.4267   5.5182
%!       4.5585   4.8833   5.7307   4.8833   5.6403   6.0701   5.5109   5.8039   4.4535   5.1739
%!       4.1849   4.5170   5.7624   5.1373   5.8430   5.8967   5.6672   5.8821   4.5219   4.7392
%!       3.8894   4.1971   5.8137   5.3790   5.9749   5.7551   5.7917   5.9505   4.3925   4.4584
%!       3.7087   4.0018   5.8210   5.6232   5.9358   5.7185   5.6989   6.0726   4.1556   4.4267
%!       3.6232   3.8064   5.9285   5.7624   5.8210   5.8210   5.4840   6.1483   3.9651   4.6025
%!       3.5695   3.9041   6.0140   5.8333   5.5280   6.0018   5.1544   6.1165   3.8772   4.8223
%!       3.7185   3.9236   5.7649   5.6867   5.1715   6.0018   4.9810   6.1776   3.9700   5.1837
%!       4.0335   3.8699   5.4132   5.3668   4.8101   5.9016   5.0616   6.2020   4.2582   5.4303
%!       4.4120   3.8064   5.0982   5.2252   4.4535   5.5573   5.1959   6.2069   4.4218   5.6525
%!       4.6293   3.7209   4.6782   5.2398   4.3803   5.1739   5.3595   5.9920   4.3363   5.8210
%!       4.5585   3.8186   4.3729   5.3546   4.5659   4.8003   5.6159   5.5646   4.2997   5.7063
%!       4.3949   4.1409   4.3925   5.5085   4.8052   4.4315   5.7624   5.1788   4.3925   5.3693
%!       4.1800   4.5292   4.5903   5.5964   5.1251   4.1947   5.8577   4.9981   4.6757   5.0274
%!       4.1971   4.8052   4.9199   5.7527   5.3546   4.0066   5.9480   5.0518   4.7612   4.7050
%!       4.4315   5.0860   5.0176   5.8748   5.5891   3.8503   5.8357   5.2325   4.6587   4.4145
%!       4.7148   5.3400   4.8589   5.9065   5.7649   3.7478   5.7063   5.4840   4.4902   4.1458
%!       4.9615   5.5329   4.6757   5.8943   5.9236   3.6428   5.4987   5.6867   4.3070   3.9651
%!       5.3009   5.5768   4.6196   5.7429   5.9407   3.5915   5.1886   5.8992   4.1263   4.0335
%!       5.5671   5.6672   4.8345   5.4474   5.8577   3.5695   5.1177   5.8699   3.9724   4.3729
%!       5.6818   5.7917   5.0909   5.0250   5.6941   3.5280   5.1910   5.9773   4.0775   4.6831 ](:);
%!
%!
%!
%! U = [ 6.4100   3.4100   6.4100   6.4100   3.4100   3.4100   3.4100   6.4100   6.4100   3.4100
%!       3.4100   3.4100   3.4100   6.4100   3.4100   3.4100   3.4100   3.4100   6.4100   3.4100
%!       6.4100   3.4100   3.4100   6.4100   3.4100   3.4100   3.4100   3.4100   6.4100   3.4100
%!       6.4100   3.4100   3.4100   6.4100   3.4100   3.4100   3.4100   3.4100   6.4100   3.4100
%!       6.4100   3.4100   6.4100   6.4100   3.4100   3.4100   3.4100   6.4100   3.4100   6.4100
%!       6.4100   3.4100   6.4100   6.4100   3.4100   3.4100   6.4100   3.4100   3.4100   6.4100
%!       6.4100   3.4100   6.4100   6.4100   3.4100   3.4100   6.4100   3.4100   3.4100   3.4100
%!       6.4100   3.4100   6.4100   3.4100   3.4100   3.4100   6.4100   3.4100   3.4100   3.4100
%!       6.4100   3.4100   6.4100   6.4100   3.4100   3.4100   6.4100   6.4100   3.4100   3.4100
%!       6.4100   3.4100   6.4100   6.4100   3.4100   3.4100   6.4100   3.4100   6.4100   3.4100
%!       6.4100   3.4100   6.4100   6.4100   3.4100   3.4100   6.4100   3.4100   6.4100   3.4100
%!       3.4100   3.4100   6.4100   6.4100   3.4100   3.4100   6.4100   6.4100   6.4100   3.4100
%!       3.4100   3.4100   6.4100   6.4100   3.4100   3.4100   3.4100   6.4100   6.4100   3.4100
%!       3.4100   3.4100   6.4100   3.4100   3.4100   3.4100   3.4100   6.4100   3.4100   3.4100
%!       3.4100   3.4100   6.4100   3.4100   3.4100   3.4100   3.4100   6.4100   3.4100   3.4100
%!       3.4100   3.4100   3.4100   3.4100   6.4100   3.4100   6.4100   6.4100   6.4100   6.4100
%!       3.4100   3.4100   6.4100   3.4100   3.4100   6.4100   3.4100   6.4100   6.4100   6.4100
%!       3.4100   3.4100   6.4100   3.4100   3.4100   6.4100   3.4100   6.4100   6.4100   3.4100
%!       3.4100   6.4100   3.4100   6.4100   3.4100   6.4100   3.4100   6.4100   6.4100   3.4100
%!       3.4100   6.4100   3.4100   6.4100   3.4100   3.4100   6.4100   6.4100   3.4100   3.4100
%!       3.4100   6.4100   3.4100   6.4100   6.4100   3.4100   6.4100   3.4100   3.4100   3.4100
%!       6.4100   6.4100   3.4100   6.4100   3.4100   3.4100   6.4100   3.4100   3.4100   3.4100
%!       3.4100   6.4100   6.4100   3.4100   3.4100   3.4100   6.4100   3.4100   6.4100   3.4100
%!       3.4100   6.4100   3.4100   3.4100   3.4100   3.4100   6.4100   3.4100   6.4100   3.4100
%!       6.4100   6.4100   3.4100   3.4100   6.4100   6.4100   6.4100   3.4100   6.4100   3.4100
%!       6.4100   3.4100   3.4100   3.4100   6.4100   6.4100   6.4100   6.4100   6.4100   3.4100
%!       6.4100   3.4100   3.4100   3.4100   3.4100   3.4100   6.4100   6.4100   6.4100   6.4100
%!       6.4100   3.4100   6.4100   3.4100   6.4100   3.4100   6.4100   3.4100   6.4100   6.4100
%!       6.4100   6.4100   6.4100   6.4100   6.4100   3.4100   3.4100   3.4100   6.4100   6.4100
%!       3.4100   6.4100   6.4100   6.4100   6.4100   3.4100   6.4100   6.4100   6.4100   6.4100
%!       3.4100   6.4100   6.4100   3.4100   6.4100   3.4100   6.4100   6.4100   3.4100   3.4100
%!       3.4100   6.4100   6.4100   3.4100   6.4100   3.4100   6.4100   6.4100   3.4100   3.4100
%!       3.4100   6.4100   6.4100   3.4100   6.4100   3.4100   6.4100   6.4100   3.4100   3.4100
%!       3.4100   6.4100   6.4100   6.4100   6.4100   3.4100   6.4100   6.4100   3.4100   6.4100
%!       3.4100   6.4100   6.4100   6.4100   6.4100   3.4100   3.4100   3.4100   3.4100   3.4100
%!       3.4100   6.4100   6.4100   6.4100   6.4100   3.4100   3.4100   3.4100   3.4100   6.4100
%!       3.4100   6.4100   6.4100   3.4100   6.4100   3.4100   3.4100   3.4100   3.4100   6.4100
%!       3.4100   6.4100   3.4100   3.4100   6.4100   3.4100   3.4100   3.4100   3.4100   6.4100
%!       3.4100   6.4100   3.4100   6.4100   6.4100   3.4100   3.4100   3.4100   3.4100   6.4100
%!       3.4100   6.4100   3.4100   6.4100   6.4100   3.4100   3.4100   3.4100   3.4100   6.4100
%!       3.4100   6.4100   3.4100   6.4100   6.4100   3.4100   3.4100   3.4100   6.4100   6.4100
%!       3.4100   6.4100   3.4100   6.4100   3.4100   3.4100   3.4100   3.4100   6.4100   6.4100
%!       3.4100   6.4100   3.4100   6.4100   3.4100   6.4100   3.4100   3.4100   6.4100   6.4100
%!       3.4100   6.4100   3.4100   6.4100   6.4100   6.4100   3.4100   3.4100   6.4100   6.4100
%!       3.4100   6.4100   3.4100   6.4100   6.4100   6.4100   6.4100   3.4100   6.4100   6.4100
%!       3.4100   6.4100   3.4100   6.4100   3.4100   6.4100   6.4100   3.4100   6.4100   3.4100
%!       3.4100   6.4100   6.4100   6.4100   3.4100   6.4100   6.4100   3.4100   3.4100   3.4100
%!       3.4100   6.4100   6.4100   6.4100   3.4100   6.4100   6.4100   3.4100   6.4100   6.4100
%!       3.4100   6.4100   3.4100   6.4100   3.4100   6.4100   3.4100   3.4100   6.4100   6.4100
%!       6.4100   6.4100   3.4100   6.4100   3.4100   6.4100   3.4100   6.4100   6.4100   6.4100
%!       6.4100   3.4100   3.4100   6.4100   3.4100   3.4100   3.4100   6.4100   6.4100   6.4100
%!       6.4100   6.4100   3.4100   6.4100   3.4100   3.4100   3.4100   6.4100   6.4100   6.4100
%!       3.4100   6.4100   3.4100   6.4100   3.4100   3.4100   3.4100   6.4100   6.4100   6.4100
%!       3.4100   6.4100   3.4100   3.4100   3.4100   3.4100   6.4100   3.4100   6.4100   6.4100
%!       3.4100   6.4100   3.4100   3.4100   3.4100   3.4100   6.4100   3.4100   6.4100   6.4100
%!       3.4100   6.4100   3.4100   3.4100   3.4100   3.4100   6.4100   3.4100   6.4100   6.4100
%!       3.4100   6.4100   6.4100   6.4100   3.4100   6.4100   6.4100   3.4100   6.4100   6.4100
%!       3.4100   6.4100   6.4100   6.4100   3.4100   3.4100   6.4100   3.4100   6.4100   3.4100
%!       6.4100   6.4100   6.4100   6.4100   3.4100   3.4100   6.4100   6.4100   6.4100   6.4100
%!       3.4100   3.4100   6.4100   6.4100   3.4100   6.4100   6.4100   6.4100   3.4100   6.4100
%!       3.4100   3.4100   3.4100   6.4100   6.4100   6.4100   6.4100   6.4100   6.4100   6.4100
%!       3.4100   6.4100   3.4100   6.4100   6.4100   6.4100   6.4100   6.4100   6.4100   6.4100
%!       3.4100   6.4100   3.4100   3.4100   6.4100   6.4100   6.4100   6.4100   3.4100   6.4100
%!       3.4100   6.4100   3.4100   3.4100   3.4100   6.4100   6.4100   6.4100   6.4100   3.4100
%!       6.4100   3.4100   3.4100   3.4100   3.4100   3.4100   6.4100   6.4100   3.4100   3.4100
%!       6.4100   3.4100   6.4100   3.4100   3.4100   6.4100   3.4100   6.4100   3.4100   3.4100
%!       6.4100   3.4100   6.4100   3.4100   3.4100   6.4100   3.4100   6.4100   3.4100   6.4100
%!       6.4100   3.4100   6.4100   3.4100   3.4100   6.4100   6.4100   3.4100   3.4100   6.4100
%!       6.4100   6.4100   6.4100   3.4100   3.4100   6.4100   6.4100   3.4100   3.4100   6.4100
%!       6.4100   6.4100   6.4100   6.4100   3.4100   6.4100   6.4100   6.4100   3.4100   6.4100
%!       6.4100   6.4100   6.4100   3.4100   3.4100   6.4100   6.4100   6.4100   3.4100   6.4100
%!       6.4100   6.4100   6.4100   3.4100   6.4100   6.4100   6.4100   6.4100   3.4100   6.4100
%!       6.4100   6.4100   6.4100   3.4100   6.4100   6.4100   6.4100   6.4100   3.4100   6.4100
%!       6.4100   6.4100   6.4100   3.4100   6.4100   6.4100   3.4100   3.4100   6.4100   6.4100
%!       3.4100   6.4100   6.4100   6.4100   6.4100   6.4100   3.4100   6.4100   6.4100   6.4100
%!       3.4100   3.4100   6.4100   6.4100   6.4100   6.4100   6.4100   6.4100   3.4100   3.4100
%!       3.4100   3.4100   3.4100   6.4100   6.4100   6.4100   6.4100   6.4100   3.4100   3.4100
%!       3.4100   3.4100   6.4100   6.4100   6.4100   6.4100   6.4100   6.4100   6.4100   3.4100
%!       3.4100   3.4100   6.4100   6.4100   6.4100   3.4100   6.4100   6.4100   3.4100   3.4100
%!       3.4100   3.4100   6.4100   6.4100   6.4100   6.4100   6.4100   6.4100   3.4100   3.4100
%!       3.4100   3.4100   6.4100   6.4100   6.4100   6.4100   3.4100   6.4100   3.4100   6.4100
%!       3.4100   3.4100   6.4100   6.4100   3.4100   6.4100   3.4100   6.4100   3.4100   6.4100
%!       3.4100   6.4100   6.4100   6.4100   3.4100   6.4100   3.4100   6.4100   3.4100   6.4100
%!       6.4100   3.4100   3.4100   3.4100   3.4100   6.4100   6.4100   6.4100   6.4100   6.4100
%!       6.4100   3.4100   3.4100   3.4100   3.4100   3.4100   6.4100   6.4100   6.4100   6.4100
%!       6.4100   3.4100   3.4100   6.4100   3.4100   3.4100   6.4100   6.4100   3.4100   6.4100
%!       3.4100   3.4100   3.4100   6.4100   6.4100   3.4100   6.4100   3.4100   3.4100   6.4100
%!       3.4100   6.4100   3.4100   6.4100   6.4100   3.4100   6.4100   3.4100   3.4100   3.4100
%!       3.4100   6.4100   6.4100   6.4100   6.4100   3.4100   6.4100   3.4100   6.4100   3.4100
%!       3.4100   6.4100   6.4100   6.4100   6.4100   3.4100   6.4100   6.4100   6.4100   3.4100
%!       6.4100   6.4100   6.4100   6.4100   6.4100   3.4100   6.4100   6.4100   3.4100   3.4100
%!       6.4100   6.4100   3.4100   6.4100   6.4100   3.4100   3.4100   6.4100   3.4100   3.4100
%!       6.4100   6.4100   3.4100   6.4100   6.4100   3.4100   6.4100   6.4100   3.4100   3.4100
%!       6.4100   6.4100   3.4100   6.4100   6.4100   3.4100   3.4100   6.4100   3.4100   3.4100
%!       6.4100   6.4100   6.4100   3.4100   6.4100   3.4100   3.4100   6.4100   3.4100   6.4100
%!       6.4100   6.4100   6.4100   3.4100   3.4100   3.4100   6.4100   6.4100   3.4100   6.4100
%!       6.4100   6.4100   6.4100   3.4100   6.4100   3.4100   6.4100   6.4100   6.4100   6.4100
%!       3.4100   6.4100   6.4100   6.4100   3.4100   3.4100   6.4100   6.4100   6.4100   6.4100
%!       3.4100   6.4100   6.4100   6.4100   3.4100   3.4100   6.4100   6.4100   6.4100   6.4100
%!       3.4100   6.4100   6.4100   3.4100   3.4100   3.4100   3.4100   6.4100   6.4100   6.4100 ](:);
%!
%!
%! DAT = iddata (Y, U);
%!
%! [SYS, X0, INFO] = moen4 (DAT, "s", 15, "rcond", 0.0, "tol", -1.0, "confirm", false);
%!
%! Ae = [  0.8924   0.3887   0.1285   0.1716
%!        -0.0837   0.6186  -0.6273  -0.4582
%!         0.0052   0.1307   0.6685  -0.6755
%!         0.0055   0.0734  -0.2148   0.4788 ];
%!
%! Ce = [ -0.4442   0.6663   0.3961   0.4102 ];
%!
%! Be = [ -0.2142
%!        -0.1968
%!         0.0525
%!         0.0361 ];
%! 
%! De = [ -0.0041 ];
%!
%! Ke = [ -1.9513
%!        -0.1867
%!         0.6348
%!        -0.3486 ];
%!
%! Qe = [  0.0052   0.0005  -0.0017   0.0009
%!         0.0005   0.0000  -0.0002   0.0001
%!        -0.0017  -0.0002   0.0006  -0.0003
%!         0.0009   0.0001  -0.0003   0.0002 ];
%!
%! Rye = [ 0.0012 ];
%!
%! Se = [ -0.0025
%!        -0.0002
%!         0.0008
%!        -0.0005 ];
%!
%! X0e = [ -11.496422
%!          -0.718576
%!          -0.014211
%!           0.500073 ];    # X0e is not from SLICOT
%!
%! ## The SLICOT test for IB01CD uses COMUSE=C, not COMUSE=U.
%! ## This means that they don't use the matrices B and D
%! ## computed by IB01BD.  They use only A and C from IB01BD,
%! ## while B and D are from SLICOT routine IB01CD.
%! ## Therefore they get slightly different matrices B and D
%! ## and finally a different initial state vector X0.
%!
%!assert (SYS.A, Ae, 1e-4);
%!assert (SYS.B, Be, 1e-4);
%!assert (SYS.C, Ce, 1e-4);
%!assert (SYS.D, De, 1e-4);
%!assert (INFO.K, Ke, 1e-4);
%!assert (INFO.Q, Qe, 1e-4);
%!assert (INFO.Ry, Rye, 1e-4);
%!assert (INFO.S, Se, 1e-4);
%!assert (X0, X0e, 1e-4);


## [96-003] Data of a 120 MW power plant (Pont-sur-Sambre, France)
%!shared SYS, Ae, Be, Ce, De
%! U = [  -811        -592         421        -680        -681
%!        -812        -619         477        -685        -651
%!        -817        -565         538        -678        -677
%!        -695        -725         536        -674        -702
%!        -697        -571         531        -676        -685
%!        -697        -618         533        -681        -721
%!        -702        -579         549        -677        -699
%!        -703        -487         575        -677        -694
%!        -705        -449         561        -679        -678
%!        -705        -431         563        -680        -692
%!        -707        -502         561        -679        -686
%!        -707        -583         530        -676        -751
%!        -710        -458         540        -677        -700
%!        -713        -469         543        -679        -731
%!        -715        -506         549        -684        -635
%!        -713        -590         532        -681        -715
%!        -714        -582         528        -676        -696
%!        -713        -575         538        -679        -690
%!        -716        -382         557        -682        -701
%!        -716        -476         558        -679        -690
%!        -718        -425         565        -678        -686
%!        -719        -409         562        -679        -615
%!        -719        -508         523        -677        -737
%!        -721        -569         523        -679        -722
%!        -723        -434         542        -681        -735
%!        -723        -395         544        -676        -704
%!        -723        -428         542        -677        -729
%!        -722        -402         537        -677        -706
%!        -725        -380         534        -681        -696
%!        -726        -324         549        -676        -701
%!        -726        -211         578        -675        -614
%!        -727        -113         569        -677        -738
%!        -727        -208         554        -676        -737
%!        -727        -320         523        -684        -697
%!        -727         944         605        -680        -587
%!        -729         396         654        -681        -708
%!        -729         754         637        -682        -685
%!        -727         419         522        -677        -715
%!        -729         378         494        -668        -703
%!        -728         363         493        -669        -682
%!        -729         390         496        -665        -713
%!        -729         106         483        -664        -711
%!        -729          32         495        -661        -718
%!        -729         517         585        -661        -641
%!        -729         455         625        -659        -703
%!        -730         521         649        -687        -669
%!        -730         540         627        -689        -705
%!        -731         514         605        -694        -682
%!        -585         525         558        -685        -611
%!        -586         534         520        -680        -668
%!        -586         539         531        -681        -679
%!        -585         519         507        -682        -663
%!        -588         513         505        -667        -668
%!        -587         509         539        -680        -616
%!        -587         512         535        -668        -628
%!        -588         514         557        -667        -648
%!        -588         553         563        -676        -613
%!        -589         519         559        -684        -638
%!        -589         521         563        -682        -652
%!        -588         518         547        -678        -597
%!        -589         552         549        -688        -630
%!        -589         520         535        -685        -623
%!        -589         547         542        -678        -619
%!        -589         549         531        -684        -524
%!        -588         544         522       -1540        -580
%!        -588         564         555       -1538        -584
%!        -588         684         545       -1541        -564
%!        -590         558         546       -1541        -609
%!        -589         552         537       -1550        -601
%!        -591         532         526       -1548        -580
%!        -590         544         524       -1542        -565
%!        -591         559         535       -1538        -604
%!        -592         555         542       -1548        -629
%!        -591         577         532       -1549        -587
%!        -593         581         530       -1543        -585
%!        -592         562         540       -1548        -583
%!        -591         568         546       -1536        -587
%!        -593         550         557       -1533        -569
%!        -592         550         537       -1518        -527
%!        -593         568         551       -1533        -582
%!        -590         528         540       -1529        -492
%!        -590         542         532       -1525        -585
%!        -590         556         535       -1522        -606
%!        -591         637         535       -1516        -571
%!        -591         608         539       -1512        -582
%!        -591         545         527       -1510        -577
%!        -591         603         534       -1507        -548
%!        -592         567         521       -1507        -539
%!        -594         560         530       -1503        -583
%!        -422         549         534       -1487        -542
%!           5         619         550       -1488        -609
%!           5         572         541       -1487        -545
%!         185         564         529       -1488        -528
%!         185         571         531       -1497        -512
%!         187         590         545       -1489        -472
%!         186         658         544       -1485        -501
%!         185         639         553       -1486        -512
%!         187         604         532       -1486        -490
%!         186         584         535       -1486        -505
%!         187         572         541       -1488        -479
%!         186         570         531       -1486        -477
%!         187         579         539       -1488        -482
%!         187         694         537       -1487        -512
%!         187         727         546       -1494        -474
%!         186         838         545       -1493        -470
%!         186         703         527       -1492        -510
%!         185         634         502       -1490        -486
%!         185         659         502       -1490        -446
%!         185         569         483       -1488        -472
%!         184         552         494       -1487        -468
%!         183         541         492       -1487        -411
%!         184         544         519       -1486        -471
%!         184         577         538       -1487        -420
%!         183         536         546       -1490        -455
%!         183         586         567       -1487        -421
%!         183         554         566       -1485        -449
%!         183         564         558       -1486        -455
%!         182         558         546       -1486        -426
%!         183         659         543       -1486        -398
%!         182         545         531       -1487        -425
%!         182         542         513       -1487        -297
%!         181         549         502       -1486        -407
%!         180         558         963       -1487        -391
%!         182         546        1105       -1487        -388
%!         179         540        1166       -1487        -387
%!         181         519        1221       -1487        -390
%!         179         510        1254       -1486        -382
%!         176         528        1289       -1487        -379
%!         178         510        1310       -1486        -389
%!         178         504        1313       -1484        -357
%!         178         507        1328       -1484        -383
%!         178         519        1333       -1489        -426
%!         183         509        1317       -1483        -377
%!         177         585        1331       -1483        -352
%!         176         765        1334       -1484        -375
%!         196         689        1328       -1484        -381
%!         178         570        1306       -1486        -398
%!         176         997        1338       -1483        -360
%!         176         839        1318       -1487        -366
%!         176         879        1324         -90        -394
%!         175         763        1302         -92        -436
%!         175         739        1307         -92        -430
%!         176         791        1336         -86        -446
%!         175         774        1301         -91        -405
%!         174         782        1304         -91        -414
%!         189         722        1335         -92        -360
%!         173         871        1341         -91        -417
%!         173         825        1337         -86        -383
%!         193         836        1332         -86        -449
%!         174         832        1325         -87        -432
%!         175         834        1326         -88        -383
%!         176         899        1332         -86        -341
%!         195         827        1296         -84        -371
%!         174         897        1311         -86        -366
%!         195         848        1320         -86        -416
%!         192         777        1286         -83         126
%!         171         788        1309         -84         153
%!         171         810        1307         -84         173
%!         174         758        1297         -85         182
%!         188         910        1329       -1036         236
%!         189         944        1344       -1669         245
%!         196         859        1330       -1668         249
%!         190         797        1320       -1669         231
%!         191         784        1341       -1665         248
%!         184         737        1335       -1656         240
%!         182         733        1342       -1655         245
%!         182         696        1350       -1653         253
%!         185         614        1341       -1658         236
%!         188         708        1370       -1654         238
%!         191         729        1366       -1655         237
%!         183         714        1380       -1651         262
%!         186         695        1378       -1651         257
%!         189         758        1387       -1649         276
%!         164         572        1364       -1649         257
%!         163         587        1343       -1650         246
%!         161         683        1353       -1658         261
%!         160         572        1359       -1654         261
%!         160         607        1355       -1651         267
%!         158         580        1349       -1655         273
%!         161         631        1362       -1652         272
%!         160         706        1382       -1657         298
%!         161         601        1356       -1654         277
%!         159         570        1354       -1653         274
%!         158         547        1347       -1657         261
%!         158         582        1332       -1657         257
%!         157         570        1340       -1657         267
%!         154         556        1343       -1657         268
%!         157         537        1345       -1657        -425
%!         158         555        1331       -1653        -581
%!         158         551        1315       -1654        -643
%!         159         590        1322       -1656        -687
%!         160         566        1315       -1657        -737
%!         160         553        1315       -1653        -767
%!         161         644        1327       -1396        -731
%!         159         640        1335        -577        -639
%!         161         726        1334        -577        -730
%!         175         729        1310        -573        -711
%!         175         854        1330        -576        -690
%!         161         729        1313        -573        -636
%!         176         706        1314        -583        -745 ];
%!
%!
%! Y = [   117         129         -47
%!         113         141         -42
%!          83         150         -37
%!         144         174          -3
%!         156         196          19
%!         174         192           6
%!         171         193           3
%!         169         224          14
%!         155         211          14
%!         137         175           4
%!         130         165          13
%!         145         172          21
%!         128         173          30
%!         119         194          30
%!         127         188          11
%!         147         176           5
%!         162         183          19
%!         173         178          14
%!         131         161           4
%!         112         139         -11
%!          91         133         -10
%!          75         127          -7
%!          80         115         -10
%!          87         132           6
%!          51         151           6
%!          28         167           3
%!          22         167          -3
%!           9         171           4
%!           7         158           6
%!         -11         155           5
%!         -87         149          -8
%!        -153         146         -12
%!        -184         116         -20
%!        -167         118           8
%!        -563          78          -4
%!        -694          -3        -155
%!       -1000         -39        -168
%!       -1101         -28        -135
%!       -1080          55           6
%!       -1075         162          89
%!       -1035         254         117
%!        -894         329         148
%!        -747         409         218
%!        -774         416         231
%!        -781         361         189
%!        -825         288         171
%!        -897         220         166
%!        -960         175         169
%!        -994         157         196
%!       -1009         202         237
%!       -1003         267         258
%!        -981         326         267
%!        -947         361         276
%!        -921         369         280
%!        -894         369         292
%!        -876         359         302
%!        -869         356         318
%!        -857         334         316
%!        -857         336         320
%!        -868         331         323
%!        -873         316         324
%!        -870         301         326
%!        -867         294         323
%!        -878         293         322
%!        -877         300         309
%!        -891         317         233
%!        -919         308         160
%!        -919         296         111
%!        -898         304          94
%!        -884         336         101
%!        -876         344          92
%!        -877         347          77
%!        -859         354          79
%!        -852         368          84
%!        -852         362          79
%!        -846         337          67
%!        -846         322          71
%!        -836         325          82
%!        -831         330          81
%!        -848         332          84
%!        -834         334          89
%!        -830         314          87
%!        -838         322          93
%!        -859         313          73
%!        -864         317          59
%!        -852         318          48
%!        -850         313          59
%!        -858         327          65
%!        -849         332          82
%!        -822         332          77
%!        -721         377         121
%!        -517         492         193
%!        -306         596         226
%!        -117         683         244
%!          22         716         212
%!          87         684         157
%!         151         642         129
%!         198         599         105
%!         233         549          93
%!         244         512          83
%!         255         487          70
%!         247         453          49
%!         225         437          32
%!         175         410           4
%!         105         386         -12
%!          86         379         -35
%!         101         382         -16
%!         111         412           3
%!         158         451          31
%!         217         486          37
%!         259         504          29
%!         301         503          24
%!         317         495           7
%!         354         472          -3
%!         361         441          -8
%!         368         413         -32
%!         362         381         -34
%!         354         370         -42
%!         310         360         -36
%!         318         369         -36
%!         313         372         -36
%!         298         377         -28
%!         311         341         -34
%!         339         292         -33
%!         362         223         -52
%!         380         161         -73
%!         397         113         -90
%!         402          64        -117
%!         398          30        -136
%!         396          12        -148
%!         390         -22        -189
%!         377         -47        -211
%!         366         -54        -227
%!         331         -52        -240
%!         227         -74        -289
%!         168        -117        -355
%!         149        -104        -357
%!          10        -101        -344
%!         -77        -115        -374
%!        -116         -88        -330
%!        -106         -53        -223
%!         -82          -4         -98
%!         -99           5         -40
%!         -89          22           3
%!         -79          34          26
%!         -74          34          42
%!        -101          28          61
%!        -102          28          73
%!        -124          22          74
%!        -125          19          90
%!        -132           9         100
%!        -167           8         102
%!        -161           7          90
%!        -185          19         105
%!        -207          29         110
%!        -295          24         159
%!        -361          17         293
%!        -411          12         436
%!        -401          48         540
%!        -441          86         601
%!        -475         118         553
%!        -448         146         472
%!        -401         172         428
%!        -366         197         400
%!        -304         231         391
%!        -252         253         387
%!        -183         261         399
%!        -123         255         405
%!        -107         247         397
%!         -76         228         392
%!         -71         205         389
%!         -66         192         381
%!         -92         171         371
%!         -40         178         356
%!         -15         185         353
%!         -27         170         359
%!          15         173         351
%!          23         175         356
%!          44         178         338
%!          47         171         323
%!           4         153         294
%!          23         141         295
%!          39         141         306
%!          52         139         313
%!          53         142         313
%!          69         142         312
%!          74         136         306
%!         196         164         277
%!         347         208         133
%!         461         230         -58
%!         526         204        -251
%!         581         161        -385
%!         588         119        -458
%!         549          63        -528
%!         497           5        -550
%!         420         -20        -498
%!         327         -49        -464
%!         198         -78        -438
%!         154         -80        -409
%!         130         -60        -377 ];
%!
%! DAT = iddata (Y, U, 1228.8);
%!
%! [SYS, X0] = moen4 (DAT, "s", 10, "n", 8, "rcond", 0.0, "tol", -1.0);
%!
%! Ae = [  0.9811   0.0574   0.3270   0.0003   0.0358   0.0403  -0.1366   0.0276
%!         0.1043   0.7634  -0.1308   0.2252   0.0203  -0.0117  -0.2328  -0.2516
%!        -0.0612   0.1437   0.8378  -0.2400   0.0367  -0.3205  -0.0367  -0.0978
%!        -0.0213   0.0149   0.0706   0.8902   0.2415  -0.1329   0.3080  -0.0143
%!        -0.0076   0.0680   0.0557  -0.0469   0.7084   0.2852   0.2565   0.1508
%!        -0.0016   0.0603   0.0071  -0.0448  -0.0870   0.8608   0.1495  -0.1148
%!         0.0046   0.0120   0.0040  -0.0272   0.0117  -0.0654   0.8348  -0.4557
%!        -0.0058   0.0133  -0.0112  -0.0171  -0.0353  -0.0892   0.3328   0.7650 ];
%!
%! Ce = [ -0.1635   0.6294   0.1157  -0.2129   0.0812  -0.0238   0.0745   0.2027
%!         0.1775   0.1736  -0.2839  -0.0750  -0.4986  -0.1254   0.3740   0.1598
%!         0.2012  -0.0045  -0.4447  -0.3289   0.4767  -0.3377   0.0200  -0.0978 ];
%!
%! Be = [ -0.0436   0.1911  -0.1345   0.0409   0.2828
%!         0.5541  -0.4223   0.0001  -0.0151  -0.1778
%!        -0.3644   0.2868   0.0754  -0.0457  -0.1691
%!        -0.0372   0.1270  -0.0772  -0.0714  -0.0255
%!        -0.1251  -0.0021   0.1094   0.0576   0.2121
%!        -0.1372   0.1139   0.0030   0.0141   0.0493
%!        -0.0187   0.0712  -0.0042   0.0075  -0.0221
%!        -0.0834   0.0509   0.0322  -0.0089   0.0009 ];
%!
%! De = [  0.1581  -0.3111  -0.0350   0.0179  -0.1403
%!        -0.0037  -0.0461  -0.1177   0.0092  -0.0242
%!         0.0476  -0.0237  -0.0159   0.0174   0.0464 ];
%!
%!assert (abs (SYS.A), abs (Ae), 1e-4);
%!assert (abs (SYS.B), abs (Be), 1e-4);
%!assert (abs (SYS.C), abs (Ce), 1e-4);
%!assert (abs (SYS.D), abs (De), 1e-4);
